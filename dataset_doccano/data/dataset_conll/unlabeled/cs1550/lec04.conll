unlabeled|cs1550|lec04
-DOCSTART- -X- -X- O

Introduction _ _ O
to _ _ O
Operating _ _ O
Systems _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
Spring _ _ O
2022 _ _ O
Sherif _ _ O
Khattab _ _ O
ksm73@pitt.edu _ _ O
( _ _ O
Some _ _ O
slides _ _ O
are _ _ O
from _ _ O
Silberschatz _ _ O
, _ _ O
Galvin _ _ O
and _ _ O
Gagne _ _ O
© _ _ O
2013 _ _ O
) _ _ O

Announcements _ _ O
• _ _ O
Upcoming _ _ O
deadlines _ _ O
• _ _ O
Homework _ _ O
1 _ _ O
is _ _ O
due _ _ O
today _ _ O
at _ _ O
11 _ _ O
: _ _ O
59 _ _ O
pm _ _ O
• _ _ O
Homework _ _ O
2 _ _ O
is _ _ O
due _ _ O
next _ _ O
Monday _ _ O
at _ _ O
11 _ _ O
: _ _ O
59 _ _ O
pm _ _ O
• _ _ O
Lab _ _ O
1 _ _ O
is _ _ O
due _ _ O
on _ _ O
2 _ _ O
/ _ _ O
4 _ _ O
at _ _ O
11 _ _ O
: _ _ O
59 _ _ O
pm _ _ O
• _ _ O
Project _ _ O
1 _ _ O
is _ _ O
due _ _ O
on _ _ O
2 _ _ O
/ _ _ O
18 _ _ O
at _ _ O
11 _ _ O
: _ _ O
59 _ _ O
pm _ _ O
• _ _ O
TA _ _ O
Office _ _ O
hours _ _ O
available _ _ O
on _ _ O
the _ _ O
syllabus _ _ O
page _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
2 _ _ O

Previous _ _ O
Lecture _ _ O
… _ _ O
• _ _ O
Busy _ _ O
waiting _ _ O
problem _ _ O
and _ _ O
how _ _ O
to _ _ O
solve _ _ O
it _ _ O
using _ _ O
semaphores _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
3 _ _ O

Muddiest _ _ O
Points _ _ O
• _ _ O
a _ _ O
little _ _ O
confused _ _ O
on _ _ O
the _ _ O
relationship _ _ O
between _ _ O
semaphores _ _ O
and _ _ O
spinlocks _ _ O
• _ _ O
what _ _ O
’s _ _ O
the _ _ O
advantage _ _ O
between _ _ O
a _ _ O
binary _ _ O
semaphore _ _ O
and _ _ O
a _ _ O
spinlock _ _ O
if _ _ O
a _ _ O
binary _ _ O
semaphore _ _ O
can _ _ O
only _ _ O
be _ _ O
for _ _ O
one _ _ O
process _ _ O
? _ _ O
• _ _ O
What _ _ O
happens _ _ O
to _ _ O
each _ _ O
process _ _ O
with _ _ O
each _ _ O
up _ _ O
( _ _ O
) _ _ O
and _ _ O
down _ _ O
( _ _ O
) _ _ O
for _ _ O
multiple _ _ O
processes _ _ O
with _ _ O
varying _ _ O
priorities _ _ O
? _ _ O
Another _ _ O
walkthrough _ _ O
basically _ _ O
• _ _ O
could _ _ O
you _ _ O
further _ _ O
explain _ _ O
how _ _ O
the _ _ O
semaphores _ _ O
with _ _ O
spinlocks _ _ O
still _ _ O
are _ _ O
able _ _ O
to _ _ O
keep _ _ O
their _ _ O
benefits _ _ O
? _ _ O
• _ _ O
• _ _ O
What _ _ O
is _ _ O
the _ _ O
point _ _ O
of _ _ O
having _ _ O
semaphores _ _ O
if _ _ O
you _ _ O
are _ _ O
going _ _ O
to _ _ O
tie _ _ O
them _ _ O
with _ _ O
spinlocks _ _ O
? _ _ O
Does _ _ O
that _ _ O
not _ _ O
defeat _ _ O
the _ _ O
benefits _ _ O
of _ _ O
using _ _ O
a _ _ O
semaphore _ _ O
? _ _ O
By _ _ O
introducing _ _ O
a _ _ O
spinlock _ _ O
within _ _ O
our _ _ O
semaphore _ _ O
implementation _ _ O
, _ _ O
does _ _ O
n't _ _ O
that _ _ O
bring _ _ O
up _ _ O
the _ _ O
issue _ _ O
of _ _ O
busy _ _ O
waiting _ _ O
? _ _ O
Or _ _ O
is _ _ O
this _ _ O
not _ _ O
an _ _ O
issue _ _ O
because _ _ O
the _ _ O
critical _ _ O
section _ _ O
is _ _ O
a _ _ O
relatively _ _ O
small _ _ O
block _ _ O
of _ _ O
code _ _ O
? _ _ O
• _ _ O
what _ _ O
is _ _ O
the _ _ O
different _ _ O
between _ _ O
swap _ _ O
and _ _ O
test _ _ O
& _ _ O
set _ _ O
? _ _ O
• _ _ O
Do _ _ O
Semaphores _ _ O
have _ _ O
the _ _ O
same _ _ O
issue _ _ O
with _ _ O
reordering _ _ O
instructions _ _ O
that _ _ O
spinlocks _ _ O
have _ _ O
? _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
4 _ _ O

• _ _ O
Muddiest _ _ O
Points _ _ O
( _ _ O
2 _ _ O
/ _ _ O
3 _ _ O
) _ _ O
where _ _ O
the _ _ O
lock _ _ O
( _ _ O
) _ _ O
and _ _ O
unlock _ _ O
( _ _ O
) _ _ O
go _ _ O
in _ _ O
the _ _ O
pseudo _ _ O
code _ _ O
of _ _ O
the _ _ O
spinlock _ _ O
in _ _ O
semaphores _ _ O
example _ _ O
• _ _ O
How _ _ O
to _ _ O
stop _ _ O
the _ _ O
up _ _ O
/ _ _ O
down _ _ O
from _ _ O
breaking _ _ O
( _ _ O
the _ _ O
if _ _ O
else _ _ O
thing _ _ O
you _ _ O
brought _ _ O
up _ _ O
at _ _ O
the _ _ O
end _ _ O
) _ _ O
• _ _ O
for _ _ O
the _ _ O
process _ _ O
list _ _ O
I _ _ O
am _ _ O
assuming _ _ O
we _ _ O
would _ _ O
use _ _ O
some _ _ O
sort _ _ O
of _ _ O
priority _ _ O
queue _ _ O
to _ _ O
sort _ _ O
the _ _ O
processes _ _ O
for _ _ O
the _ _ O
ProcessList _ _ O
? _ _ O
• _ _ O
How _ _ O
a _ _ O
spinlock _ _ O
is _ _ O
implemented _ _ O
in _ _ O
a _ _ O
semaphore _ _ O
• _ _ O
I _ _ O
think _ _ O
the _ _ O
functional _ _ O
difference _ _ O
between _ _ O
blocking _ _ O
and _ _ O
waiting _ _ O
. _ _ O
As _ _ O
in _ _ O
, _ _ O
what _ _ O
is _ _ O
actually _ _ O
happening _ _ O
while _ _ O
a _ _ O
process _ _ O
is _ _ O
infinite _ _ O
looping _ _ O
and _ _ O
awaiting _ _ O
a _ _ O
lock _ _ O
? _ _ O
Since _ _ O
it _ _ O
's _ _ O
not _ _ O
" _ _ O
blocked _ _ O
" _ _ O
, _ _ O
does _ _ O
that _ _ O
mean _ _ O
that _ _ O
it _ _ O
prevents _ _ O
other _ _ O
processes _ _ O
from _ _ O
running _ _ O
, _ _ O
or _ _ O
can _ _ O
it _ _ O
be _ _ O
context _ _ O
switched _ _ O
out _ _ O
like _ _ O
any _ _ O
normal _ _ O
process _ _ O
? _ _ O
• _ _ O
which _ _ O
implementation _ _ O
is _ _ O
most _ _ O
commonly _ _ O
used _ _ O
for _ _ O
semaphores _ _ O
• _ _ O
difference _ _ O
between _ _ O
counting _ _ O
and _ _ O
binary _ _ O
semaphore _ _ O
( _ _ O
why _ _ O
counting _ _ O
would _ _ O
be _ _ O
used _ _ O
) _ _ O
• _ _ O
can _ _ O
the _ _ O
semaphore _ _ O
be _ _ O
> _ _ O
0 _ _ O
, _ _ O
and _ _ O
if _ _ O
so _ _ O
what _ _ O
does _ _ O
that _ _ O
mean _ _ O
? _ _ O
• _ _ O
How _ _ O
are _ _ O
spinlocks _ _ O
implemented _ _ O
in _ _ O
hardware _ _ O
? _ _ O
Are _ _ O
they _ _ O
the _ _ O
only _ _ O
locking _ _ O
mechanism _ _ O
implemented _ _ O
in _ _ O
hardware _ _ O
? _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
5 _ _ O

Muddiest _ _ O
Points _ _ O
( _ _ O
3 _ _ O
/ _ _ O
3 _ _ O
) _ _ O
• _ _ O
How _ _ O
process _ _ O
states _ _ O
are _ _ O
switched _ _ O
/ _ _ O
clarification _ _ O
on _ _ O
ready _ _ O
/ _ _ O
waiting _ _ O
/ _ _ O
running _ _ O
• _ _ O
What _ _ O
does _ _ O
the _ _ O
comment _ _ O
above _ _ O
the _ _ O
line _ _ O
of _ _ O
assembly _ _ O
code _ _ O
mean _ _ O
? _ _ O
• _ _ O
I _ _ O
'm _ _ O
curious _ _ O
about _ _ O
memory _ _ O
barriers _ _ O
. _ _ O
could _ _ O
you _ _ O
talk _ _ O
more _ _ O
about _ _ O
how _ _ O
to _ _ O
use _ _ O
_ _ _ O
sync_synchronize _ _ O
( _ _ O
) _ _ O
and _ _ O
how _ _ O
it _ _ O
works _ _ O
? _ _ O
• _ _ O
Where _ _ O
exactly _ _ O
the _ _ O
code _ _ O
blocks _ _ O
• _ _ O
from _ _ O
the _ _ O
tophat _ _ O
question _ _ O
: _ _ O
why _ _ O
can _ _ O
down _ _ O
move _ _ O
a _ _ O
process _ _ O
into _ _ O
ready _ _ O
• _ _ O
When _ _ O
/ _ _ O
why _ _ O
is _ _ O
reordering _ _ O
instructions _ _ O
in _ _ O
a _ _ O
critical _ _ O
section _ _ O
beneficial _ _ O
? _ _ O
• _ _ O
Today _ _ O
, _ _ O
We _ _ O
heard _ _ O
" _ _ O
Block _ _ O
" _ _ O
a _ _ O
lot _ _ O
but _ _ O
it _ _ O
has _ _ O
the _ _ O
same _ _ O
meaning _ _ O
• _ _ O
Implementation _ _ O
of _ _ O
mutex _ _ O
vs _ _ O
standard _ _ O
semaphore _ _ O
• _ _ O
When _ _ O
would _ _ O
you _ _ O
know _ _ O
to _ _ O
use _ _ O
a _ _ O
spinlock _ _ O
instead _ _ O
of _ _ O
a _ _ O
semaphore _ _ O
? _ _ O
• _ _ O
Why _ _ O
two _ _ O
context _ _ O
switches _ _ O
in _ _ O
semaphore _ _ O
• _ _ O
What _ _ O
is _ _ O
/ _ _ O
makes _ _ O
an _ _ O
operation _ _ O
atomic _ _ O
? _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
6 _ _ O

Semaphore _ _ O
Usage _ _ O
Problem _ _ O
: _ _ O
Compromising _ _ O
Mutual _ _ O
Exclusion _ _ O
• _ _ O
Any _ _ O
process _ _ O
can _ _ O
up _ _ O
( _ _ O
) _ _ O
the _ _ O
semaphore _ _ O
• _ _ O
Solution _ _ O
: _ _ O
A _ _ O
Mutex _ _ O
can _ _ O
be _ _ O
up _ _ O
( _ _ O
) _ _ O
’d _ _ O
only _ _ O
by _ _ O
the _ _ O
same _ _ O
process _ _ O
that _ _ O
down _ _ O
( _ _ O
) _ _ O
’d _ _ O
it _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
7 _ _ O

• _ _ O
• _ _ O
Semaphore _ _ O
Usage _ _ O
Problem _ _ O
: _ _ O
Deadlock _ _ O
and _ _ O
Starvation _ _ O
Deadlock _ _ O
: _ _ O
two _ _ O
or _ _ O
more _ _ O
processes _ _ O
are _ _ O
waiting _ _ O
indefinitely _ _ O
for _ _ O
an _ _ O
event _ _ O
that _ _ O
can _ _ O
only _ _ O
be _ _ O
caused _ _ O
by _ _ O
a _ _ O
waiting _ _ O
process _ _ O
• _ _ O
P0 _ _ O
gets _ _ O
A _ _ O
, _ _ O
needs _ _ O
B _ _ O
• _ _ O
P1 _ _ O
gets _ _ O
B _ _ O
, _ _ O
needs _ _ O
A _ _ O
• _ _ O
Each _ _ O
process _ _ O
waiting _ _ O
for _ _ O
the _ _ O
other _ _ O
to _ _ O
signal _ _ O
Shared _ _ O
variables _ _ O
Semaphore _ _ O
A _ _ O
( _ _ O
1 _ _ O
) _ _ O
, _ _ O
B _ _ O
( _ _ O
1 _ _ O
) _ _ O
; _ _ O
Starvation _ _ O
: _ _ O
indefinite _ _ O
blocking _ _ O
• _ _ O
Process _ _ O
is _ _ O
never _ _ O
removed _ _ O
from _ _ O
the _ _ O
semaphore _ _ O
queue _ _ O
in _ _ O
which _ _ O
its _ _ O
suspended _ _ O
• _ _ O
May _ _ O
be _ _ O
caused _ _ O
by _ _ O
ordering _ _ O
in _ _ O
queues _ _ O
( _ _ O
priority _ _ O
) _ _ O
Process _ _ O
P0 _ _ O
A.down _ _ O
( _ _ O
) _ _ O
; _ _ O
B.down _ _ O
( _ _ O
) _ _ O
; _ _ O
. _ _ O
. _ _ O
. _ _ O
B.up _ _ O
( _ _ O
) _ _ O
; _ _ O
A.up _ _ O
( _ _ O
) _ _ O
; _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
Process _ _ O
P1 _ _ O
B.down _ _ O
( _ _ O
) _ _ O
; _ _ O
A.down _ _ O
( _ _ O
) _ _ O
; _ _ O
. _ _ O
. _ _ O
. _ _ O
A.up _ _ O
( _ _ O
) _ _ O
; _ _ O
B.up _ _ O
( _ _ O
) _ _ O
; _ _ O
8 _ _ O

Semaphore _ _ O
Usage _ _ O
Problem _ _ O
: _ _ O
Priority _ _ O
Inversion _ _ O
• _ _ O
Priority _ _ O
inversion _ _ O
is _ _ O
still _ _ O
possible _ _ O
using _ _ O
semaphores _ _ O
• _ _ O
Slightly _ _ O
less _ _ O
likely _ _ O
• _ _ O
Needs _ _ O
at _ _ O
least _ _ O
three _ _ O
processes _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
9 _ _ O

fork _ _ O
( _ _ O
) _ _ O
tracing _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
10 _ _ O

fork _ _ O
( _ _ O
) _ _ O
’s _ _ O
of _ _ O
fork _ _ O
( _ _ O
) _ _ O
’s _ _ O
CS _ _ O
/ _ _ O
COE _ _ O
1550 _ _ O
– _ _ O
Operating _ _ O
Systems _ _ O
– _ _ O
Sherif _ _ O
Khattab _ _ O
11 _ _ O



