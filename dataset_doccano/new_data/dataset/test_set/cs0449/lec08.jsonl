{"id": 8, "segment": ["test_set", "labeled"], "course": "cs0449", "lec": "lec08", "text": "8\n\nInvestigating\nthe Code\n\nCS/COE 0449\nIntroduction to\nSystems Software\n\nLuis Oliveira\n(with content borrowed from wilkie and Vinicius Petrucci)\n\nGoing with the Flow\nTracing the footsteps\n\n2\n\nBringing back our alphabet soup: The C ABI\n\u2022 The C Application Binary Interface (ABI) are assembly conventions\n\u2022 Like MIPS, certain registers are typically used for returns values, args, etc\n\u2022 It is not defined by the language, but rather the OS.\n\u2022 Windows and Linux (UNIX/System V) have a different C ABI \uf04c\n\n\u2022 In our x86-64 Linux C ABI, registers are used to pass arguments:\n\u2022\n,\n,\n,\n,\n,\n(First, second, etc) (Like MIPS\n-\n)\n\u2022 Remaining arguments go on the stack.\n\u2022 Callee must preserve\n,\n,\n,\n,\n,\n(Like MIPS\n-\n\u2022 Return value:\n(overflows into\nfor 128-bits) (MIPS\n-\n)\n\u2022 Lots of other small things not worth going over.\n\n)\n\n\u2022 For reference: https://github.com/hjl-tools/x86-psABI/wiki/x86-64-psABI-1.0.pdf\n3\n\nFunction, function... what's your... function\n\u2022 The activation frame contains\ntemporary data needed by the function.\n\u2022\n\u2022\n\u2022\nC\n\nis the return value\nis the current stack address\nis the address of this frame\n\nWhat goes here?\n\nx86-64 (gas / AT&T syntax,\n\n)\n\n4\n\nOh, that's your function\n\u2022 First: it fills the activation frame\nwith initial variable values.\n\u2022 It may not allocate them in\nany strict order. Here, it\nallocates x first and further away.\nx86-64 (gas / AT&T syntax,\n\n-\n)\n\n-\nPreserves\n(caller activation frame)\nAllocates \" \" on stack (\nfrom top)\nAllocates \" \" on stack (\nfrom top)\n(it does not have to be in order)\n\nResets caller activation frame\nReturns (return value is in\n)\n\n5\n\nThese are actual sandwiches (no hot dogs or w/e)\n\u2022 When identifying\nfunctions, you are\nlooking for that\ntell-tale sandwich\npattern.\n\u2022A\nis a good sign\nof the beginning of a\nfunction\n\u2022 And the\nwill\nhappen before the\nat the end.\n\u2022 Everything between is\nthe sweet, sweet jam\nthat makes it unique.\n\n6\n\nWho controls the\n\u2022 Control flow is a\n\u2022\n\u2022\n\nwill set\nwill set\n\n\u2022\n\ngroup set\n\nor\n\ncontrols the flow\nfollowed by\n\nbased on the difference (subtraction) between values\nbased on bitwise AND of both values (faster, but less useful)\n\n(program counter) to an address based on\n\n\u2022 Often it is much more useful to just interpret the\nC\n\nx86-64 (gas / AT&T syntax,\n\n(\n\nis\n\n)\n)\n\n7\n\nWho controls the\n\u2022\n\ncontrols the flow\n\nhas bits that are set based on the ALU (CPU math logic) result\n- most significant bit of result\n- set if overflow occurred\n\n\u2022 Each jump looks at different\n- Jumps when\nC\n\nWorks because of 2's\ncomplement math.\n(thus, instead of its strict definition,\nbetter to think about it abstractly)\n\n- set if result is zero\n- set if last bit operation has carry\n\npatterns. (Look 'em up!)\n- set if\n\nor\n\nx86-64 (gas / AT&T syntax,\n\n)\n\nPerform x - 0 (does nothing!)\nJump if the result (that is, x)\ndoes not have a set sign bit.\n(x is positive in that case)\nPerform x - y\nJump if the result is 0 or\nif result is negative after overflow\nor positive and didn't overflow.\n(x is >= y in these cases)\n\n8\n\ncmp, simplifying... the confusion\n\u2022 Just remember that the order of operands is not the... best order...\n\u2022 It's kinda swapped around in the AT&T syntax we have been looking at:\nJump if x > 0\n\nJump if x >= y\n\nWe negate the\ncondition\nBecause we are\ndeciding when to\nskip the code!\n\nJump if x < y\n\nJump if x != y\n\n9\n\ntest... adding some new confusion\n\u2022\n\nis somewhat stranger... and requires some more thought.\n\u2022 performs an AND of the arguments and sets flags on result\n\n\u2022 Thankfully, generally only commonly used in a couple of cases.\n\u2022 Generally to test a value against \"true\" or \"false\".\n\u2022 Recall that\nand\nwill look at the zero flag (\n)\n\u2022 Keep in mind that jumps are built around\n(which performs:\nWe negate the\ncondition\n\n)...\n\nJump if x != 0\n(\n?)\n\nJump if x == 0\n(\n?)\nCS/COE 0449 - Spring 2019/2020\n\n10\n\nPatterns\n\u2022 Control flow is a\nC\n\n/\n\nbefore a\n-\n-\nx86-64 (gas / AT&T syntax,\n\n)\n\n11\n\nAltogether now... Working backward\n\nNegate logic to form \"if\" logic\n\nNegate logic to form \"if\" logic\n\n12\n\nDeduction, dear watson\nNo use of\n\n... likely no arguments\n\nTwo stack allocations ... Two local variables.\n(initialized to 5 and, likely, -2)\n\nLooking at\n\n... This simply returns zero.\n\n13\n\nConventional wisdom: counting arguments\n\nReadies\n... second argument!\nReadies\n... first argument!\nSince they are\n... yep! Both 32-bit!\nLike a\nin MIPS. A function call.\n\nStill have to follow the\n\nto the assembly of the function.\n\n14\n\nConventional wisdom: counting arguments\n\nCopies\n... function argument!\nCopies\n... second argument!\nSince they are\n... They are both 32-bit!\nis the return address...\nmeans it is a 32-bit return\n\n15\n\n", "label": [[243, 271, "Concept"], [231, 234, "Concept"], [273, 276, "Concept"], [494, 497, "Concept"], [525, 528, "Concept"], [241, 271, "Concept"], [229, 234, "Concept"], [492, 497, "Concept"], [523, 528, "Concept"], [282, 302, "Concept"], [510, 516, "Concept"], [873, 879, "Concept"], [1119, 1125, "Concept"], [1340, 1346, "Concept"], [2202, 2208, "Concept"], [2674, 2680, "Concept"], [3821, 3827, "Concept"], [324, 333, "Concept"], [530, 539, "Concept"], [557, 566, "Concept"], [628, 637, "Concept"], [3400, 3409, "Concept"], [4010, 4019, "Concept"], [4181, 4190, "Concept"], [4414, 4423, "Concept"], [4211, 4219, "Concept"], [4239, 4247, "Concept"], [4445, 4453, "Concept"], [4473, 4481, "Concept"], [648, 653, "Concept"], [1058, 1063, "Concept"], [1428, 1433, "Concept"], [1463, 1468, "Concept"], [4025, 4030, "Concept"], [657, 663, "Concept"], [703, 715, "Concept"], [1030, 1042, "Concept"], [1556, 1568, "Concept"], [949, 965, "Concept"], [1200, 1216, "Concept"], [1393, 1409, "Concept"], [1530, 1546, "Concept"], [1386, 1409, "Concept"], [1523, 1546, "Concept"], [1897, 1909, "Concept"], [3784, 3796, "Concept"], [2105, 2120, "Concept"], [2050, 2061, "Concept"], [2319, 2322, "Concept"], [2324, 2338, "Concept"], [2787, 2795, "Concept"], [3591, 3600, "Concept"], [2389, 2397, "Concept"], [2895, 2903, "Concept"], [2927, 2935, "Concept"], [2628, 2633, "Concept"], [2968, 2971, "Concept"], [3282, 3286, "Concept"], [3516, 3520, "Concept"], [1133, 1144, "Concept"], [1354, 1365, "Concept"], [2216, 2227, "Concept"], [2688, 2699, "Concept"], [3108, 3119, "Concept"], [3835, 3846, "Concept"], [1127, 1130, "Concept"], [1348, 1351, "Concept"], [2210, 2213, "Concept"], [2682, 2685, "Concept"], [3829, 3832, "Concept"], [310, 314, "Concept"], [607, 611, "Concept"], [694, 698, "Concept"], [748, 752, "Concept"], [4296, 4300, "Concept"], [1058, 1071, "Concept"], [4051, 4066, "Concept"], [4304, 4317, "Concept"], [4531, 4545, "Concept"]]}