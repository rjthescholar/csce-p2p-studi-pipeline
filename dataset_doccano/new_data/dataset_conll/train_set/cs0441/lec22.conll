['train_set', 'labeled']|cs0441|lec22
-DOCSTART- -X- -X- O

Discrete _ _ O
Structures _ _ O
for _ _ O
Computer _ _ O
Science _ _ O


 _ _ O
William _ _ O
Garrison _ _ O
bill@cs.pitt.edu _ _ O
6311 _ _ O
Sennott _ _ O
Square _ _ O
Lecture _ _ O
# _ _ O
22 _ _ O
: _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept


 _ _ O
Based _ _ O
on _ _ O
materials _ _ O
developed _ _ O
by _ _ O
Dr. _ _ O
Adam _ _ O
Lee _ _ O


 _ _ O
Today _ _ O
's _ _ O
Topics _ _ O
n _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept
l _ _ O
What _ _ O
do _ _ O
we _ _ O
compute _ _ O
conditional _ _ O
probabilities _ _ O
with _ _ O
incomplete _ _ O
information _ _ O
? _ _ O


 _ _ O
Conditional _ _ B-Concept
Probability _ _ I-Concept
Definition _ _ O
: _ _ O
Let _ _ O
E _ _ O
and _ _ O
F _ _ O
be _ _ O
events _ _ O
with _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
> _ _ O
0 _ _ O
. _ _ O
The _ _ O
conditional _ _ O
probability _ _ O
of _ _ O
E _ _ O
given _ _ O
F _ _ O
, _ _ O
denoted _ _ O
p _ _ O
( _ _ O
E _ _ O
| _ _ O
F _ _ O
) _ _ O
, _ _ O
is _ _ O
defined _ _ O
as _ _ O
: _ _ O


 _ _ O
p _ _ O
E∩F _ _ O
p _ _ O
E _ _ O
F _ _ O
= _ _ O
p _ _ O
F _ _ O


 _ _ O
Intuition _ _ O
: _ _ O
l _ _ O
Think _ _ O
of _ _ O
the _ _ O
event _ _ O
F _ _ O
as _ _ O
reducing _ _ O
the _ _ O
sample _ _ O
space _ _ O
that _ _ O
can _ _ O
be _ _ O
considered _ _ O
l _ _ O
The _ _ O
numerator _ _ O
looks _ _ O
at _ _ O
the _ _ O
likelihood _ _ O
of _ _ O
the _ _ O
outcomes _ _ O
in _ _ O
E _ _ O
that _ _ O
overlap _ _ O
those _ _ O
in _ _ O
F _ _ O
l _ _ O
The _ _ O
denominator _ _ O
accounts _ _ O
for _ _ O
the _ _ O
reduction _ _ O
in _ _ O
sample _ _ O
size _ _ O
indicated _ _ O
by _ _ O
our _ _ O
prior _ _ O
knowledge _ _ O
that _ _ O
F _ _ O
has _ _ O
occurred _ _ O


 _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept
allows _ _ O
us _ _ O
to _ _ O
relate _ _ O
the _ _ O
conditional _ _ O
and _ _ O
marginal _ _ O
probabilities _ _ O
of _ _ O
two _ _ O
random _ _ O
events _ _ O
. _ _ O


 _ _ O
? _ _ O
In _ _ O
English _ _ O
: _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept
will _ _ O
help _ _ O
us _ _ O
assess _ _ O
the _ _ O
probability _ _ O
that _ _ O
an _ _ O
event _ _ O
occurred _ _ O
given _ _ O
only _ _ O
partial _ _ O
evidence _ _ O
. _ _ O
Does _ _ O
n't _ _ O
our _ _ O
formula _ _ O
for _ _ O
conditional _ _ B-Concept
probability _ _ I-Concept
do _ _ O
this _ _ O
already _ _ O
? _ _ O


 _ _ O
We _ _ O
ca _ _ O
n't _ _ O
always _ _ O
use _ _ O
this _ _ O
formula _ _ O
directly _ _ O
... _ _ O


 _ _ O
A _ _ O
Motivating _ _ O
Example _ _ O
Suppose _ _ O
that _ _ O
a _ _ O
certain _ _ O
drug _ _ O
test _ _ O
correctly _ _ O
identifies _ _ O
a _ _ O
person _ _ O
who _ _ O
use _ _ O
the _ _ O
drug _ _ O
as _ _ O
testing _ _ O
positive _ _ O
99 _ _ O
% _ _ O
of _ _ O
the _ _ O
time _ _ O
, _ _ O
and _ _ O
will _ _ O
correctly _ _ O
identify _ _ O
a _ _ O
non-user _ _ O
as _ _ O
testing _ _ O
negative _ _ O
99 _ _ O
% _ _ O
of _ _ O
the _ _ O
time _ _ O
. _ _ O
If _ _ O
a _ _ O
company _ _ O
suspects _ _ O
that _ _ O
0.5 _ _ O
% _ _ O
of _ _ O
its _ _ O
employees _ _ O
are _ _ O
users _ _ O
of _ _ O
the _ _ O
drug _ _ O
, _ _ O
what _ _ O
is _ _ O
the _ _ O
probability _ _ O
that _ _ O
an _ _ O
employee _ _ O
that _ _ O
tests _ _ O
positive _ _ O
for _ _ O
this _ _ O
drug _ _ O
is _ _ O
actually _ _ O
a _ _ O
user _ _ O
? _ _ O


 _ _ O
Question _ _ O
: _ _ O
Can _ _ O
we _ _ O
use _ _ O
our _ _ O
simple _ _ O
conditional _ _ B-Concept
probability _ _ I-Concept
formula _ _ O
? _ _ O
p _ _ O
EF _ _ O
= _ _ O


 _ _ O
X _ _ O
is _ _ O
a _ _ O
user _ _ O


 _ _ O
! _ _ O
( _ _ O
# _ _ O
∩% _ _ O
) _ _ O
! _ _ O
( _ _ O
% _ _ O
) _ _ O


 _ _ O
X _ _ O
tested _ _ O
positive _ _ O


 _ _ O
The _ _ O
1 _ _ O
, _ _ O
000 _ _ O
foot _ _ O
view _ _ O
... _ _ O
In _ _ O
situations _ _ O
like _ _ O
those _ _ O
on _ _ O
the _ _ O
last _ _ O
slide _ _ O
, _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
theorem _ _ I-Concept
can _ _ O
help _ _ O
! _ _ O
Essentially _ _ O
, _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
theorem _ _ I-Concept
will _ _ O
allow _ _ O
us _ _ O
to _ _ O
calculate _ _ O
P _ _ O
( _ _ O
E|F _ _ O
) _ _ O
assuming _ _ O
that _ _ O
we _ _ O
know _ _ O
( _ _ O
or _ _ O
can _ _ O
derive _ _ O
) _ _ O
: _ _ O
l _ _ O
P _ _ O
E _ _ O
l _ _ O
P _ _ O
FE _ _ O
& _ _ O
l _ _ O
P _ _ O
( _ _ O
F|E _ _ O
) _ _ O


 _ _ O
Probability _ _ O
that _ _ O
X _ _ O
is _ _ O
a _ _ O
user _ _ O
Test _ _ O
success _ _ O
rate _ _ O
Test _ _ O
false _ _ B-Concept
positive _ _ I-Concept
rate _ _ B-Concept


 _ _ O
Probability _ _ O
that _ _ O
X _ _ O
is _ _ O
a _ _ O
user _ _ O
of _ _ O
the _ _ O
drug _ _ O
, _ _ O
given _ _ O
a _ _ O
positive _ _ O
test _ _ O


 _ _ O
Returning _ _ O
to _ _ O
our _ _ O
earlier _ _ O
example _ _ O
: _ _ O
l _ _ O
Let _ _ O
E _ _ O
= _ _ O
" _ _ O
Person _ _ O
X _ _ O
is _ _ O
a _ _ O
user _ _ O
of _ _ O
the _ _ O
drug _ _ O
" _ _ O
l _ _ O
Let _ _ O
F _ _ O
= _ _ O
" _ _ O
Person _ _ O
X _ _ O
tested _ _ O
positive _ _ O
for _ _ O
the _ _ O
drug _ _ O
" _ _ O


 _ _ O
It _ _ O
sounds _ _ O
like _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept
could _ _ O
help _ _ O
in _ _ O
this _ _ O
case _ _ O
... _ _ O


 _ _ O
New _ _ O
Notation _ _ O
To _ _ O
simplify _ _ O
expressions _ _ O
, _ _ O
we _ _ O
will _ _ O
use _ _ O
the _ _ O
notation _ _ O
EC _ _ O
to _ _ O
denote _ _ O
the _ _ O
complementary _ _ B-Concept
event _ _ I-Concept
of _ _ O
E _ _ O
That _ _ O
is _ _ O
: _ _ O


 _ _ O
C _ _ O
E=E _ _ O


 _ _ O
A _ _ O
Simple _ _ O
Example _ _ O
We _ _ O
have _ _ O
two _ _ O
boxes _ _ O
. _ _ O
The _ _ O
first _ _ O
contains _ _ O
two _ _ O
green _ _ O
balls _ _ O
and _ _ O
seven _ _ O
red _ _ O
balls _ _ O
. _ _ O
The _ _ O
second _ _ O
contains _ _ O
four _ _ O
green _ _ O
balls _ _ O
and _ _ O
three _ _ O
red _ _ O
balls _ _ O
. _ _ O
Bob _ _ O
selects _ _ O
a _ _ O
ball _ _ O
by _ _ O
first _ _ O
choosing _ _ O
a _ _ O
box _ _ O
at _ _ O
random _ _ O
. _ _ O
He _ _ O
then _ _ O
selects _ _ O
one _ _ O
of _ _ O
the _ _ O
balls _ _ O
from _ _ O
that _ _ O
box _ _ O
at _ _ O
random _ _ O
. _ _ O
If _ _ O
Bob _ _ O
has _ _ O
selected _ _ O
a _ _ O
red _ _ O
ball _ _ O
, _ _ O
what _ _ O
is _ _ O
the _ _ O
probability _ _ O
that _ _ O
he _ _ O
took _ _ O
it _ _ O
from _ _ O
the _ _ O
first _ _ O
box _ _ O
? _ _ O


 _ _ O
1 _ _ O


 _ _ O
2 _ _ O


 _ _ O
Picking _ _ O
the _ _ O
problem _ _ O
apart _ _ O
... _ _ O
First _ _ O
, _ _ O
let _ _ O
's _ _ O
define _ _ O
a _ _ O
few _ _ O
events _ _ O
relevant _ _ O
to _ _ O
this _ _ O
problem _ _ O
: _ _ O
l _ _ O
Let _ _ O
E _ _ O
= _ _ O
Bob _ _ O
has _ _ O
chosen _ _ O
a _ _ O
red _ _ O
ball _ _ O
l _ _ O
By _ _ O
definition _ _ O
EC _ _ O
= _ _ O
Bob _ _ O
has _ _ O
chosen _ _ O
a _ _ O
green _ _ O
ball _ _ O
l _ _ O
Let _ _ O
F _ _ O
= _ _ O
Bob _ _ O
chose _ _ O
his _ _ O
ball _ _ O
from _ _ O
this _ _ O
first _ _ O
box _ _ O
l _ _ O
Therefore _ _ O
, _ _ O
FC _ _ O
= _ _ O
Bob _ _ O
chose _ _ O
his _ _ O
ball _ _ O
from _ _ O
the _ _ O
second _ _ O
box _ _ O


 _ _ O
We _ _ O
want _ _ O
to _ _ O
find _ _ O
the _ _ O
probability _ _ O
that _ _ O
Bob _ _ O
chose _ _ O
from _ _ O
the _ _ O
first _ _ O
box _ _ O
, _ _ O
given _ _ O
that _ _ O
he _ _ O
picked _ _ O
a _ _ O
red _ _ O
ball _ _ O
. _ _ O
That _ _ O
is _ _ O
, _ _ O
we _ _ O
want _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
. _ _ O
Goal _ _ O
: _ _ O
Given _ _ O
that _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
F _ _ O
∩ _ _ O
E _ _ O
) _ _ O
/ _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
, _ _ O
use _ _ O
what _ _ O
we _ _ O
know _ _ O
to _ _ O
derive _ _ O
p _ _ O
( _ _ O
F _ _ O
∩ _ _ O
E _ _ O
) _ _ O
and _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
. _ _ O


 _ _ O
What _ _ O
do _ _ O
we _ _ O
know _ _ O
? _ _ O
We _ _ O
have _ _ O
two _ _ O
boxes _ _ O
. _ _ O
The _ _ O
first _ _ O
contains _ _ O
two _ _ O
green _ _ O
balls _ _ O
and _ _ O
seven _ _ O
red _ _ O
balls _ _ O
. _ _ O
The _ _ O
second _ _ O
contains _ _ O
four _ _ O
green _ _ O
balls _ _ O
and _ _ O
three _ _ O
red _ _ O
balls _ _ O
. _ _ O
Bob _ _ O
selects _ _ O
a _ _ O
ball _ _ O
by _ _ O
first _ _ O
choosing _ _ O
a _ _ O
box _ _ O
at _ _ O
random _ _ O
. _ _ O
He _ _ O
then _ _ O
selects _ _ O
one _ _ O
of _ _ O
the _ _ O
balls _ _ O
from _ _ O
that _ _ O
box _ _ O
at _ _ O
random _ _ O
. _ _ O
If _ _ O
Bob _ _ O
has _ _ O
selected _ _ O
a _ _ O
red _ _ O
ball _ _ O
, _ _ O
what _ _ O
is _ _ O
the _ _ O
probability _ _ O
that _ _ O
he _ _ O
took _ _ O
it _ _ O
from _ _ O
the _ _ O
first _ _ O
box _ _ O
? _ _ O
Statement _ _ O
: _ _ O
Bob _ _ O
selects _ _ O
a _ _ O
ball _ _ O
by _ _ O
first _ _ O
choosing _ _ O
a _ _ O
box _ _ O
at _ _ O
random _ _ O
l _ _ O
Bob _ _ O
is _ _ O
equally _ _ O
likely _ _ O
to _ _ O
choose _ _ O
the _ _ O
first _ _ O
box _ _ O
, _ _ O
or _ _ O
the _ _ O
second _ _ O
box _ _ O
l _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
1 _ _ O
/ _ _ O
2 _ _ O


 _ _ O
Statement _ _ O
: _ _ O
The _ _ O
first _ _ O
contains _ _ O
two _ _ O
green _ _ O
balls _ _ O
and _ _ O
seven _ _ O
red _ _ O
balls _ _ O
l _ _ O
The _ _ O
first _ _ O
box _ _ O
has _ _ O
nine _ _ O
balls _ _ O
, _ _ O
seven _ _ O
of _ _ O
which _ _ O
are _ _ O
red _ _ O
l _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
7 _ _ O
/ _ _ O
9 _ _ O


 _ _ O
Statement _ _ O
: _ _ O
The _ _ O
second _ _ O
contains _ _ O
four _ _ O
green _ _ O
balls _ _ O
and _ _ O
three _ _ O
red _ _ O
balls _ _ O
l _ _ O
The _ _ O
second _ _ O
box _ _ O
contains _ _ O
seven _ _ O
balls _ _ O
, _ _ O
three _ _ O
of _ _ O
which _ _ O
are _ _ O
red _ _ O
l _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
3 _ _ O
/ _ _ O
7 _ _ O


 _ _ O
Now _ _ O
, _ _ O
for _ _ O
a _ _ O
little _ _ O
algebra _ _ O
... _ _ O
The _ _ O
end _ _ O
goal _ _ O
: _ _ O
Compute _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
F _ _ O
∩ _ _ O
E _ _ O
) _ _ O
/ _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
Note _ _ O
that _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
/ _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
l _ _ O
If _ _ O
we _ _ O
multiply _ _ O
by _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
, _ _ O
we _ _ O
get _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
l _ _ O
Further _ _ O
, _ _ O
we _ _ O
know _ _ O
that _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
7 _ _ O
/ _ _ O
9 _ _ O
and _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
1 _ _ O
/ _ _ O
2 _ _ O
l _ _ O
So _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
= _ _ O
7 _ _ O
/ _ _ O
9 _ _ O
× _ _ O
1 _ _ O
/ _ _ O
2 _ _ O
= _ _ O
7 _ _ O
/ _ _ O
18 _ _ O


 _ _ O
Recall _ _ O
: _ _ O
•p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
1 _ _ O
/ _ _ O
2 _ _ O
•p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
7 _ _ O
/ _ _ O
9 _ _ O
•p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
3 _ _ O
/ _ _ O
7 _ _ O


 _ _ O
Similarly _ _ O
, _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
FC _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
3 _ _ O
/ _ _ O
7 _ _ O
× _ _ O
1 _ _ O
/ _ _ O
2 _ _ O
= _ _ O
3 _ _ O
/ _ _ O
14 _ _ O
Observation _ _ O
: _ _ O
E _ _ O
= _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
∪ _ _ O
( _ _ O
E _ _ O
∩ _ _ O
FC _ _ O
) _ _ O
l _ _ O
This _ _ O
means _ _ O
that _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
+ _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
FC _ _ O
) _ _ O
l _ _ O
l _ _ O
l _ _ O
l _ _ O


 _ _ O
= _ _ O
7 _ _ O
/ _ _ O
18 _ _ O
+ _ _ O
3 _ _ O
/ _ _ O
14 _ _ O
= _ _ O
49 _ _ O
/ _ _ O
126 _ _ O
+ _ _ O
27 _ _ O
/ _ _ O
126 _ _ O
= _ _ O
76 _ _ O
/ _ _ O
126 _ _ O
= _ _ O
38 _ _ O
/ _ _ O
63 _ _ O


 _ _ O
Denouement _ _ O
The _ _ O
end _ _ O
goal _ _ O
: _ _ O
Compute _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
F _ _ O
∩ _ _ O
E _ _ O
) _ _ O
/ _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
So _ _ O
, _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
= _ _ O
( _ _ O
7 _ _ O
/ _ _ O
18 _ _ O
) _ _ O
/ _ _ O
( _ _ O
38 _ _ O
/ _ _ O
63 _ _ O
) _ _ O
≈ _ _ O
0.645 _ _ O


 _ _ O
Recall _ _ O
: _ _ O
•p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
1 _ _ O
/ _ _ O
2 _ _ O
•p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
7 _ _ O
/ _ _ O
9 _ _ O
•p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
3 _ _ O
/ _ _ O
7 _ _ O
•p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
= _ _ O
7 _ _ O
/ _ _ O
18 _ _ O
•p _ _ O
( _ _ O
E _ _ O
) _ _ O
= _ _ O
38 _ _ O
/ _ _ O
63 _ _ O


 _ _ O
How _ _ O
did _ _ O
we _ _ O
get _ _ O
here _ _ O
? _ _ O
1 _ _ O
. _ _ O
2 _ _ O
. _ _ O


 _ _ O
Extract _ _ O
what _ _ O
we _ _ O
could _ _ O
from _ _ O
the _ _ O
problem _ _ O
definition _ _ O
itself _ _ O
Rearrange _ _ O
terms _ _ O
to _ _ O
derive _ _ O
p _ _ O
( _ _ O
F _ _ O
∩ _ _ O
E _ _ O
) _ _ O
and _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O


 _ _ O
3 _ _ O
. _ _ O


 _ _ O
Use _ _ O
our _ _ O
trusty _ _ O
definition _ _ O
of _ _ O
conditional _ _ B-Concept
probability _ _ I-Concept
to _ _ O
do _ _ O
the _ _ O
rest _ _ O
! _ _ O


 _ _ O
The _ _ O
reasoning _ _ O
that _ _ O
we _ _ O
used _ _ O
in _ _ O
the _ _ O
last _ _ O
problem _ _ O
essentially _ _ O
derives _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept
for _ _ O
us _ _ O
! _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept
: _ _ O
Suppose _ _ O
that _ _ O
E _ _ O
and _ _ O
F _ _ O
are _ _ O
events _ _ O
from _ _ O
some _ _ O
sample _ _ O
space _ _ O
S _ _ O
such _ _ O
that _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
≠ _ _ O
0 _ _ O
and _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
≠ _ _ O
0 _ _ O
. _ _ O
Then _ _ O
: _ _ O
p _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
p _ _ O
F _ _ O
E _ _ O
= _ _ O
P _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
+ _ _ O
p _ _ O
E _ _ O
F _ _ O
' _ _ O
p _ _ O
F _ _ O
' _ _ O


 _ _ O
Proof _ _ O
: _ _ O
l _ _ O
The _ _ O
definition _ _ O
of _ _ O
conditional _ _ B-Concept
probability _ _ I-Concept
says _ _ O
that _ _ O
➣ _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
F _ _ O
∩ _ _ O
E _ _ O
) _ _ O
/ _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
➣ _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
/ _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O


 _ _ O
l _ _ O
This _ _ O
means _ _ O
that _ _ O
➣ _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
➣ _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O


 _ _ O
l _ _ O
So _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
l _ _ O
Therefore _ _ O
, _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
/ _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O


 _ _ O
Proof _ _ O
( _ _ O
continued _ _ O
) _ _ O
Note _ _ O
: _ _ O
To _ _ O
finish _ _ O
, _ _ O
we _ _ O
must _ _ O
prove _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E _ _ O
| _ _ O
F _ _ O
) _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
+ _ _ O
p _ _ O
( _ _ O
E _ _ O
| _ _ O
FC _ _ O
) _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
l _ _ O
Observe _ _ O
that _ _ O
E _ _ O
= _ _ O
E _ _ O
∩ _ _ O
S _ _ O
l _ _ O
= _ _ O
E _ _ O
∩ _ _ O
( _ _ O
F _ _ O
∪ _ _ O
FC _ _ O
) _ _ O
l _ _ O
= _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
∪ _ _ O
( _ _ O
E _ _ O
∩ _ _ O
FC _ _ O
) _ _ O
l _ _ O
Note _ _ O
also _ _ O
that _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
and _ _ O
( _ _ O
E _ _ O
∩ _ _ O
FC _ _ O
) _ _ O
are _ _ O
disjoint _ _ O
( _ _ O
i.e. _ _ O
, _ _ O
no _ _ O
x _ _ O
can _ _ O
be _ _ O
in _ _ O
both _ _ O
F _ _ O
and _ _ O
FC _ _ O
) _ _ O
l _ _ O
This _ _ O
means _ _ O
that _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
+ _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
FC _ _ O
) _ _ O
l _ _ O
We _ _ O
already _ _ O
have _ _ O
shown _ _ O
that _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
l _ _ O
Further _ _ O
, _ _ O
since _ _ O
p _ _ O
( _ _ O
E _ _ O
| _ _ O
FC _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
FC _ _ O
) _ _ O
/ _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
, _ _ O
we _ _ O
have _ _ O
that _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
FC _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
l _ _ O
So _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
+ _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
FC _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
+ _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O


 _ _ O
Putting _ _ O
everything _ _ O
together _ _ O
, _ _ O
we _ _ O
get _ _ O
: _ _ O
p _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
p _ _ O
F _ _ O
E _ _ O
= _ _ O
P _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
+ _ _ O
p _ _ O
E _ _ O
F _ _ O
' _ _ O
p _ _ O
F _ _ O
' _ _ O
❏ _ _ O


 _ _ O
And _ _ O
why _ _ O
is _ _ O
this _ _ O
useful _ _ O
? _ _ O
In _ _ O
a _ _ O
nutshell _ _ O
, _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept
is _ _ O
useful _ _ O
if _ _ O
you _ _ O
want _ _ O
to _ _ O
find _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
, _ _ O
but _ _ O
you _ _ O
do _ _ O
n't _ _ O
know _ _ O
p _ _ O
( _ _ O
E _ _ O
∩ _ _ O
F _ _ O
) _ _ O
or _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
. _ _ O


 _ _ O
Here _ _ O
's _ _ O
a _ _ O
general _ _ O
solution _ _ O
tactic _ _ O
Step _ _ O
1 _ _ O
: _ _ O
Identify _ _ O
the _ _ O
independent _ _ B-Concept
events _ _ I-Concept
that _ _ O
are _ _ O
being _ _ O
investigated _ _ O
. _ _ O
For _ _ O
example _ _ O
: _ _ O
l _ _ O
F _ _ O
= _ _ O
Bob _ _ O
chooses _ _ O
the _ _ O
first _ _ O
box _ _ O
, _ _ O
FC _ _ O
= _ _ O
Bob _ _ O
chooses _ _ O
the _ _ O
second _ _ O
box _ _ O
l _ _ O
E _ _ O
= _ _ O
Bob _ _ O
chooses _ _ O
a _ _ O
red _ _ O
ball _ _ O
, _ _ O
EC _ _ O
= _ _ O
Bob _ _ O
chooses _ _ O
a _ _ O
green _ _ O
ball _ _ O


 _ _ O
Step _ _ O
2 _ _ O
: _ _ O
Record _ _ O
the _ _ O
probabilities _ _ O
identified _ _ O
in _ _ O
the _ _ O
problem _ _ O
statement _ _ O
. _ _ O
For _ _ O
example _ _ O
: _ _ O
l _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
1 _ _ O
/ _ _ O
2 _ _ O
l _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
7 _ _ O
/ _ _ O
9 _ _ O
l _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
3 _ _ O
/ _ _ O
7 _ _ O


 _ _ O
Step _ _ O
3 _ _ O
: _ _ O
Plug _ _ O
into _ _ O
Bayes _ _ O
' _ _ O
formula _ _ O
and _ _ O
solve _ _ O


 _ _ O
Example _ _ O
: _ _ O
Pants _ _ O
and _ _ O
Skirts _ _ O
Suppose _ _ O
there _ _ O
is _ _ O
a _ _ O
co-ed _ _ O
school _ _ O
having _ _ O
60 _ _ O
% _ _ O
boys _ _ O
and _ _ O
40 _ _ O
% _ _ O
girls _ _ O
as _ _ O
students _ _ O
. _ _ O
The _ _ O
girl _ _ O
students _ _ O
wear _ _ O
pants _ _ O
or _ _ O
skirts _ _ O
in _ _ O
equal _ _ O
numbers _ _ O
; _ _ O
the _ _ O
boys _ _ O
all _ _ O
wear _ _ O
pants _ _ O
. _ _ O
An _ _ O
observer _ _ O
sees _ _ O
a _ _ O
( _ _ O
random _ _ O
) _ _ O
student _ _ O
from _ _ O
a _ _ O
distance _ _ O
; _ _ O
all _ _ O
they _ _ O
can _ _ O
see _ _ O
is _ _ O
that _ _ O
this _ _ O
student _ _ O
is _ _ O
wearing _ _ O
pants _ _ O
. _ _ O
What _ _ O
is _ _ O
the _ _ O
probability _ _ O
this _ _ O
student _ _ O
is _ _ O
a _ _ O
girl _ _ O
? _ _ O
Step _ _ O
1 _ _ O
: _ _ O
Set _ _ O
up _ _ O
events _ _ O
l _ _ O
l _ _ O
l _ _ O
l _ _ O


 _ _ O
E _ _ O
= _ _ O
X _ _ O
is _ _ O
wearing _ _ O
pants _ _ O
EC _ _ O
= _ _ O
X _ _ O
is _ _ O
wearing _ _ O
a _ _ O
skirt _ _ O
F _ _ O
= _ _ O
X _ _ O
is _ _ O
a _ _ O
girl _ _ O
FC _ _ O
= _ _ O
X _ _ O
is _ _ O
a _ _ O
boy _ _ O


 _ _ O
Step _ _ O
2 _ _ O
: _ _ O
Extract _ _ O
probabilities _ _ O
from _ _ O
problem _ _ O
definition _ _ O
l _ _ O
l _ _ O
l _ _ O
l _ _ O


 _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
0.4 _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
0.6 _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
EC|F _ _ O
) _ _ O
= _ _ O
0.5 _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
1 _ _ O


 _ _ O
Pants _ _ O
and _ _ O
Skirts _ _ O
( _ _ O
continued _ _ O
) _ _ O
p _ _ O
F _ _ O
E _ _ O
= _ _ O


 _ _ O
p _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
P _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
+ _ _ O
p _ _ O
E _ _ O
F _ _ O
! _ _ O
p _ _ O
F _ _ O
! _ _ O


 _ _ O
Step _ _ O
3 _ _ O
: _ _ O
Plug _ _ O
in _ _ O
to _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept


 _ _ O
Recall _ _ O
: _ _ O
• _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
0.4 _ _ O
• _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
0.6 _ _ O
• _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
EC|F _ _ O
) _ _ O
= _ _ O
0.5 _ _ O
• _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
1 _ _ O


 _ _ O
l _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
= _ _ O
( _ _ O
0.5 _ _ O
× _ _ O
0.4 _ _ O
) _ _ O
/ _ _ O
( _ _ O
0.5 _ _ O
× _ _ O
0.4 _ _ O
+ _ _ O
1 _ _ O
× _ _ O
0.6 _ _ O
) _ _ O
l _ _ O
= _ _ O
0.2 _ _ O
/ _ _ O
0.8 _ _ O
l _ _ O
= _ _ O
1 _ _ O
/ _ _ O
4 _ _ O


 _ _ O
Conclusion _ _ O
: _ _ O
There _ _ O
is _ _ O
a _ _ O
25 _ _ O
% _ _ O
chance _ _ O
that _ _ O
the _ _ O
person _ _ O
seen _ _ O
was _ _ O
a _ _ O
girl _ _ O
, _ _ O
given _ _ O
that _ _ O
they _ _ O
were _ _ O
wearing _ _ O
pants _ _ O
. _ _ O


 _ _ O
Drug _ _ B-Concept
screening _ _ I-Concept
, _ _ O
revisited _ _ O
Suppose _ _ O
that _ _ O
a _ _ O
certain _ _ O
drug _ _ O
test _ _ O
correctly _ _ O
identifies _ _ O
a _ _ O
person _ _ O
who _ _ O
uses _ _ O
the _ _ O
drug _ _ O
as _ _ O
testing _ _ O
positive _ _ O
99 _ _ O
% _ _ O
of _ _ O
the _ _ O
time _ _ O
, _ _ O
and _ _ O
will _ _ O
correctly _ _ O
identify _ _ O
a _ _ O
non-user _ _ O
as _ _ O
testing _ _ O
negative _ _ O
99 _ _ O
% _ _ O
of _ _ O
the _ _ O
time _ _ O
. _ _ O
If _ _ O
a _ _ O
company _ _ O
suspects _ _ O
that _ _ O
0.5 _ _ O
% _ _ O
of _ _ O
its _ _ O
employees _ _ O
are _ _ O
users _ _ O
of _ _ O
the _ _ O
drug _ _ O
, _ _ O
what _ _ O
is _ _ O
the _ _ O
probability _ _ O
that _ _ O
an _ _ O
employee _ _ O
that _ _ O
tests _ _ O
positive _ _ O
for _ _ O
this _ _ O
drug _ _ O
is _ _ O
actually _ _ O
a _ _ O
user _ _ O
? _ _ O
Step _ _ O
1 _ _ O
: _ _ O
Set _ _ O
up _ _ O
events _ _ O
l _ _ O
l _ _ O
l _ _ O
l _ _ O


 _ _ O
F _ _ O
= _ _ O
X _ _ O
is _ _ O
a _ _ O
user _ _ O
FC _ _ O
= _ _ O
X _ _ O
is _ _ O
not _ _ O
a _ _ O
user _ _ O
E _ _ O
= _ _ O
X _ _ O
tests _ _ O
positive _ _ O
for _ _ O
the _ _ O
drug _ _ O
EC _ _ O
= _ _ O
X _ _ O
tests _ _ O
negative _ _ O
for _ _ O
the _ _ O
drug _ _ O


 _ _ O
Step _ _ O
2 _ _ O
: _ _ O
Extract _ _ O
probabilities _ _ O
from _ _ O
problem _ _ O
definition _ _ O
l _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
0.005 _ _ O
l _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
0.995 _ _ O
l _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
0.99 _ _ O
l _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
0.01 _ _ O


 _ _ O
Drug _ _ B-Concept
screening _ _ I-Concept
( _ _ O
continued _ _ O
) _ _ O
p _ _ O
F _ _ O
E _ _ O
= _ _ O


 _ _ O
p _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
P _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
+ _ _ O
p _ _ O
E _ _ O
F _ _ O
! _ _ O
p _ _ O
F _ _ O
! _ _ O


 _ _ O
Step _ _ O
3 _ _ O
: _ _ O
Plug _ _ O
in _ _ O
to _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
Theorem _ _ I-Concept


 _ _ O
Recall _ _ O
: _ _ O
• _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
0.005 _ _ O
• _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
0.995 _ _ O
• _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
0.99 _ _ O
• _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
0.01 _ _ O


 _ _ O
l _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
= _ _ O
( _ _ O
0.99 _ _ O
× _ _ O
0.005 _ _ O
) _ _ O
/ _ _ O
( _ _ O
0.99 _ _ O
× _ _ O
0.005 _ _ O
+ _ _ O
0.01 _ _ O
× _ _ O
0.995 _ _ O
) _ _ O
l _ _ O
= _ _ O
0.3322 _ _ O


 _ _ O
Conclusion _ _ O
: _ _ O
If _ _ O
an _ _ O
employee _ _ O
tests _ _ O
positive _ _ O
for _ _ O
the _ _ O
drug _ _ O
, _ _ O
there _ _ O
is _ _ O
only _ _ O
a _ _ O
33 _ _ O
% _ _ O
chance _ _ O
that _ _ O
they _ _ O
are _ _ O
actually _ _ O
a _ _ O
user _ _ O
! _ _ O


 _ _ O
In-class _ _ O
exercises _ _ O
Suppose _ _ O
that _ _ O
1 _ _ O
person _ _ O
in _ _ O
100 _ _ O
, _ _ O
000 _ _ O
has _ _ O
a _ _ O
particular _ _ O
rare _ _ O
disease _ _ O
. _ _ O
A _ _ O
diagnostic _ _ O
test _ _ O
is _ _ O
correct _ _ O
99 _ _ O
% _ _ O
of _ _ O
the _ _ O
time _ _ O
when _ _ O
given _ _ O
to _ _ O
someone _ _ O
with _ _ O
the _ _ O
disease _ _ O
, _ _ O
and _ _ O
is _ _ O
correct _ _ O
99.5 _ _ O
% _ _ O
of _ _ O
the _ _ O
time _ _ O
when _ _ O
given _ _ O
to _ _ O
someone _ _ O
without _ _ O
the _ _ O
disease _ _ O
. _ _ O
Problem _ _ O
1 _ _ O
: _ _ O
Calculate _ _ O
the _ _ O
probability _ _ O
that _ _ O
someone _ _ O
who _ _ O
tests _ _ O
positive _ _ O
for _ _ O
the _ _ O
disease _ _ O
actually _ _ O
has _ _ O
it _ _ O
. _ _ O
Problem _ _ O
2 _ _ O
: _ _ O
Calculate _ _ O
the _ _ O
probability _ _ O
that _ _ O
someone _ _ O
who _ _ O
tests _ _ O
negative _ _ O
for _ _ O
the _ _ O
disease _ _ O
does _ _ O
not _ _ O
have _ _ O
the _ _ O
disease _ _ O
. _ _ O


 _ _ O
Application _ _ O
: _ _ O
Spam _ _ B-Concept
filtering _ _ O
Definition _ _ O
: _ _ O
Spam _ _ B-Concept
is _ _ O
unsolicited _ _ O
bulk _ _ O
email _ _ O
I _ _ O
did _ _ O
n't _ _ O
ask _ _ O
for _ _ O
it _ _ O
, _ _ O
I _ _ O
probably _ _ O
do _ _ O
n't _ _ O
want _ _ O
it _ _ O


 _ _ O
Sent _ _ O
to _ _ O
lots _ _ O
of _ _ O
people _ _ O
... _ _ O


 _ _ O
In _ _ O
recent _ _ O
years _ _ O
, _ _ O
spam _ _ B-Concept
has _ _ O
become _ _ O
increasingly _ _ O
problematic _ _ O
. _ _ O
For _ _ O
example _ _ O
, _ _ O
in _ _ O
2015 _ _ O
, _ _ O
spam _ _ B-Concept
accounted _ _ O
for _ _ O
~50 _ _ O
% _ _ O
of _ _ O
all _ _ O
email _ _ O
messages _ _ O
sent _ _ O
. _ _ O
To _ _ O
combat _ _ O
this _ _ O
problem _ _ O
, _ _ O
people _ _ O
have _ _ O
developed _ _ O
spam _ _ B-Concept
filters _ _ O
based _ _ O
on _ _ O
Bayes _ _ B-Concept
' _ _ I-Concept
theorem _ _ I-Concept
! _ _ O


 _ _ O
How _ _ O
does _ _ O
a _ _ O
Bayesian _ _ B-Concept
spam _ _ I-Concept
filter _ _ I-Concept
work _ _ O
? _ _ O
Essentially _ _ O
, _ _ O
these _ _ O
filters _ _ O
determine _ _ O
the _ _ O
probability _ _ O
that _ _ O
a _ _ O
message _ _ O
is _ _ O
spam _ _ O
, _ _ O
given _ _ O
that _ _ O
it _ _ O
contains _ _ O
certain _ _ O
keywords _ _ O
. _ _ O
p _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
p _ _ O
F _ _ O
E _ _ O
= _ _ O
P _ _ O
E _ _ O
F _ _ O
p _ _ O
F _ _ O
+ _ _ O
p _ _ O
E _ _ O
F _ _ O
' _ _ O
p _ _ O
F _ _ O
' _ _ O
Message _ _ O
is _ _ O
spam _ _ O


 _ _ O
Message _ _ O
contains _ _ O
questionable _ _ O
keyword _ _ O


 _ _ O
In _ _ O
the _ _ O
above _ _ O
equation _ _ O
: _ _ O
l _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
Probability _ _ O
that _ _ O
our _ _ O
keyword _ _ O
occurs _ _ O
in _ _ O
spam _ _ O
messages _ _ O
l _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
Probability _ _ O
that _ _ O
our _ _ O
keyword _ _ O
occurs _ _ O
in _ _ O
legitimate _ _ O
messages _ _ O
l _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
Probability _ _ O
that _ _ O
an _ _ O
arbitrary _ _ O
message _ _ O
is _ _ O
spam _ _ O
l _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
Probability _ _ O
that _ _ O
an _ _ O
arbitrary _ _ O
message _ _ O
is _ _ O
legitimate _ _ O


 _ _ O
Question _ _ O
: _ _ O
How _ _ O
do _ _ O
we _ _ O
derive _ _ O
these _ _ O
parameters _ _ O
? _ _ O


 _ _ O
We _ _ O
can _ _ O
learn _ _ O
these _ _ O
parameters _ _ O
by _ _ O
examining _ _ O
historical _ _ O
email _ _ O
traces _ _ O
Imagine _ _ O
that _ _ O
we _ _ O
have _ _ O
a _ _ O
corpus _ _ O
of _ _ O
email _ _ O
messages _ _ O
... _ _ O
We _ _ O
can _ _ O
ask _ _ O
a _ _ O
few _ _ O
intelligent _ _ O
questions _ _ O
to _ _ O
learn _ _ O
the _ _ O
parameters _ _ O
of _ _ O
our _ _ O
Bayesian _ _ O
filter _ _ O
: _ _ O
l _ _ O
How _ _ O
many _ _ O
of _ _ O
these _ _ O
messages _ _ O
do _ _ O
we _ _ O
consider _ _ O
spam _ _ O
? _ _ O
l _ _ O
In _ _ O
the _ _ O
spam _ _ O
messages _ _ O
, _ _ O
how _ _ O
often _ _ O
does _ _ O
our _ _ O
keyword _ _ O
appear _ _ O
? _ _ O
l _ _ O
In _ _ O
the _ _ O
good _ _ O
messages _ _ O
, _ _ O
how _ _ O
often _ _ O
does _ _ O
our _ _ O
keyword _ _ O
appear _ _ O
? _ _ O


 _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O


 _ _ O
Aside _ _ O
: _ _ O
This _ _ O
is _ _ O
what _ _ O
happens _ _ O
when _ _ O
you _ _ O
click _ _ O
the _ _ O
" _ _ O
mark _ _ O
as _ _ O
spam _ _ O
" _ _ O
button _ _ O
in _ _ O
your _ _ O
email _ _ O
client _ _ O
! _ _ O


 _ _ O
Given _ _ O
this _ _ O
information _ _ O
, _ _ O
we _ _ O
can _ _ O
apply _ _ O
Bayes _ _ O
' _ _ O
theorem _ _ O
! _ _ O


 _ _ O
Filtering _ _ O
spam _ _ O
using _ _ O
a _ _ O
single _ _ O
keyword _ _ O
Suppose _ _ O
that _ _ O
the _ _ O
keyword _ _ O
" _ _ O
Rolex _ _ O
" _ _ O
occurs _ _ O
in _ _ O
250 _ _ O
of _ _ O
2000 _ _ O
known _ _ O
spam _ _ O
messages _ _ O
, _ _ O
and _ _ O
in _ _ O
5 _ _ O
of _ _ O
1000 _ _ O
known _ _ O
good _ _ O
messages _ _ O
. _ _ O
Estimate _ _ O
the _ _ O
probability _ _ O
that _ _ O
an _ _ O
incoming _ _ O
message _ _ O
containing _ _ O
the _ _ O
word _ _ O
" _ _ O
Rolex _ _ O
" _ _ O
is _ _ O
spam _ _ O
, _ _ O
assuming _ _ O
that _ _ O
it _ _ O
is _ _ O
equally _ _ O
likely _ _ O
that _ _ O
an _ _ O
incoming _ _ O
message _ _ O
is _ _ O
spam _ _ O
or _ _ O
not _ _ O
spam _ _ O
. _ _ O
If _ _ O
our _ _ O
threshold _ _ O
for _ _ O
classifying _ _ O
a _ _ O
message _ _ O
as _ _ O
spam _ _ O
is _ _ O
0.9 _ _ O
, _ _ O
will _ _ O
we _ _ O
reject _ _ O
this _ _ O
message _ _ O
? _ _ O
Step _ _ O
1 _ _ O
: _ _ O
Define _ _ O
events _ _ O
l _ _ O
F _ _ O
= _ _ O
message _ _ O
is _ _ O
spam _ _ O
l _ _ O
FC _ _ O
= _ _ O
message _ _ O
is _ _ O
good _ _ O
l _ _ O
E _ _ O
= _ _ O
message _ _ O
contains _ _ O
the _ _ O
keyword _ _ O
" _ _ O
Rolex _ _ O
" _ _ O
l _ _ O
EC _ _ O
= _ _ O
message _ _ O
does _ _ O
not _ _ O
contain _ _ O
the _ _ O
keyword _ _ O
" _ _ O
Rolex _ _ O
" _ _ O


 _ _ O
Step _ _ O
2 _ _ O
: _ _ O
Gather _ _ O
probabilities _ _ O
from _ _ O
the _ _ O
problem _ _ O
statement _ _ O
l _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
0.5 _ _ O
l _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
250 _ _ O
/ _ _ O
2000 _ _ O
= _ _ O
0.125 _ _ O
l _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
5 _ _ O
/ _ _ O
1000 _ _ O
= _ _ O
0.005 _ _ O


 _ _ O
Spam _ _ O
Rolexes _ _ O
( _ _ O
continued _ _ O
) _ _ O
Recall _ _ O
: _ _ O
• _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
0.5 _ _ O
• _ _ O
p _ _ O
( _ _ O
E|F _ _ O
) _ _ O
= _ _ O
0.125 _ _ O
• _ _ O
p _ _ O
( _ _ O
E|FC _ _ O
) _ _ O
= _ _ O
0.005 _ _ O


 _ _ O
Step _ _ O
3 _ _ O
: _ _ O
Plug _ _ O
in _ _ O
to _ _ O
Bayes _ _ O
' _ _ O
Theorem _ _ O
l _ _ O
p _ _ O
( _ _ O
F|E _ _ O
) _ _ O
= _ _ O
( _ _ O
0.125 _ _ O
× _ _ O
0.5 _ _ O
) _ _ O
/ _ _ O
( _ _ O
0.125 _ _ O
× _ _ O
0.5 _ _ O
+ _ _ O
0.005 _ _ O
× _ _ O
0.5 _ _ O
) _ _ O
l _ _ O
= _ _ O
0.125 _ _ O
/ _ _ O
( _ _ O
0.125 _ _ O
+ _ _ O
0.005 _ _ O
) _ _ O
l _ _ O
≈ _ _ O
0.962 _ _ O


 _ _ O
Conclusion _ _ O
: _ _ O
Since _ _ O
the _ _ O
probability _ _ O
that _ _ O
our _ _ O
message _ _ O
is _ _ O
spam _ _ O
given _ _ O
that _ _ O
it _ _ O
contains _ _ O
the _ _ O
string _ _ O
" _ _ O
Rolex _ _ O
" _ _ O
is _ _ O
approximately _ _ O
0.962 _ _ O
> _ _ O
0.9 _ _ O
, _ _ O
we _ _ O
will _ _ O
discard _ _ O
the _ _ O
message _ _ O
. _ _ O


 _ _ O
Problems _ _ O
with _ _ O
this _ _ O
simple _ _ O
filter _ _ O
How _ _ O
would _ _ O
you _ _ O
choose _ _ O
a _ _ O
single _ _ O
keyword _ _ O
/ _ _ O
phrase _ _ O
to _ _ O
use _ _ O
? _ _ O
l _ _ O
" _ _ O
All _ _ O
natural _ _ O
" _ _ O
l _ _ O
" _ _ O
Nigeria _ _ O
" _ _ O
l _ _ O
" _ _ O
Click _ _ O
here _ _ O
" _ _ O
l _ _ O
... _ _ O


 _ _ O
Users _ _ O
get _ _ O
upset _ _ O
if _ _ O
false _ _ O
positives _ _ O
occur _ _ O
, _ _ O
i.e. _ _ O
, _ _ O
if _ _ O
legitimate _ _ O
messages _ _ O
are _ _ O
incorrectly _ _ O
classified _ _ O
as _ _ O
spam _ _ O
l _ _ O
When _ _ O
was _ _ O
the _ _ O
last _ _ O
time _ _ O
you _ _ O
checked _ _ O
your _ _ O
spam _ _ O
folder _ _ O
? _ _ O


 _ _ O
How _ _ O
can _ _ O
we _ _ O
fix _ _ O
this _ _ O
? _ _ O
l _ _ O
Choose _ _ O
keywords _ _ O
so _ _ O
p _ _ O
( _ _ O
spam _ _ O
| _ _ O
keyword _ _ O
) _ _ O
is _ _ O
very _ _ O
high _ _ O
or _ _ O
very _ _ O
low _ _ O
l _ _ O
Filter _ _ O
based _ _ O
on _ _ O
multiple _ _ O
keywords _ _ O


 _ _ O
Specifically _ _ O
, _ _ O
we _ _ O
want _ _ O
to _ _ O
develop _ _ O
a _ _ O
Bayesian _ _ O
filter _ _ O
that _ _ O
tells _ _ O
us _ _ O
p _ _ O
( _ _ O
F _ _ O
| _ _ O
E1 _ _ O
∩ _ _ O
E2 _ _ O
) _ _ O
First _ _ O
, _ _ O
some _ _ O
assumptions _ _ O
1 _ _ O
. _ _ O
Events _ _ O
E1 _ _ O
and _ _ O
E2 _ _ O
are _ _ O
independent _ _ O
2 _ _ O
. _ _ O
The _ _ O
events _ _ O
E1|F _ _ O
and _ _ O
E2|F _ _ O
are _ _ O
independent _ _ O
3 _ _ O
. _ _ O
p _ _ O
( _ _ O
F _ _ O
) _ _ O
= _ _ O
p _ _ O
( _ _ O
FC _ _ O
) _ _ O
= _ _ O
0.5 _ _ O


 _ _ O
By _ _ O
Bayes _ _ O
' _ _ O
theorem _ _ O


 _ _ O
Now _ _ O
, _ _ O
let _ _ O
's _ _ O
derive _ _ O
formula _ _ O
for _ _ O
this _ _ O
p _ _ O
( _ _ O
F _ _ O
| _ _ O
E1 _ _ O
∩ _ _ O
E2 _ _ O
) _ _ O
p _ _ O
F _ _ O
E _ _ O
( _ _ O
∩ _ _ O
E _ _ O
) _ _ O
= _ _ O
= _ _ O
= _ _ O


 _ _ O
p _ _ O
E _ _ O
( _ _ O


 _ _ O
p _ _ O
E _ _ O
( _ _ O
∩ _ _ O
E _ _ O
) _ _ O


 _ _ O
p _ _ O
E _ _ O
( _ _ O
∩ _ _ O
E _ _ O
) _ _ O
∣ _ _ O
F _ _ O
p _ _ O
F _ _ O
F _ _ O
p _ _ O
F _ _ O
+ _ _ O
p _ _ O
E _ _ O
( _ _ O
∩ _ _ O
E _ _ O
) _ _ O
F _ _ O
' _ _ O
p _ _ O
F _ _ O
' _ _ O


 _ _ O
p _ _ O
( _ _ O
E _ _ O
( _ _ O
∩ _ _ O
E _ _ O
) _ _ O
∣ _ _ O
F _ _ O
) _ _ O
p _ _ O
E _ _ O
( _ _ O
∩ _ _ O
E _ _ O
) _ _ O
F _ _ O
+ _ _ O
p _ _ O
E _ _ O
( _ _ O
∩ _ _ O
E _ _ O
) _ _ O
F _ _ O
' _ _ O


 _ _ O
Assumption _ _ O
3 _ _ O
Assumptions _ _ O
1 _ _ O
and _ _ O
2 _ _ O


 _ _ O
p _ _ O
E _ _ O
( _ _ O
F _ _ O
p _ _ O
( _ _ O
E _ _ O
) _ _ O
∣ _ _ O
F _ _ O
) _ _ O
F _ _ O
p _ _ O
E _ _ O
) _ _ O
F _ _ O
+ _ _ O
p _ _ O
E _ _ O
( _ _ O
F _ _ O
' _ _ O
p _ _ O
E _ _ O
) _ _ O
F _ _ O
' _ _ O


 _ _ O
Spam _ _ O
filtering _ _ O
on _ _ O
two _ _ O
keywords _ _ O
Suppose _ _ O
that _ _ O
we _ _ O
train _ _ O
a _ _ O
Bayesian _ _ O
spam _ _ O
filter _ _ O
on _ _ O
a _ _ O
set _ _ O
of _ _ O
2000 _ _ O
spam _ _ O
messages _ _ O
and _ _ O
1000 _ _ O
messages _ _ O
that _ _ O
are _ _ O
not _ _ O
spam _ _ O
. _ _ O
The _ _ O
word _ _ O
" _ _ O
stock _ _ O
" _ _ O
appears _ _ O
in _ _ O
400 _ _ O
spam _ _ O
messages _ _ O
and _ _ O
60 _ _ O
good _ _ O
messages _ _ O
, _ _ O
and _ _ O
the _ _ O
word _ _ O
" _ _ O
undervalued _ _ O
" _ _ O
appears _ _ O
in _ _ O
200 _ _ O
spam _ _ O
messages _ _ O
and _ _ O
25 _ _ O
good _ _ O
messages _ _ O
. _ _ O
Estimate _ _ O
the _ _ O
probability _ _ O
that _ _ O
a _ _ O
message _ _ O
containing _ _ O
the _ _ O
words _ _ O
" _ _ O
stock _ _ O
" _ _ O
and _ _ O
" _ _ O
undervalued _ _ O
" _ _ O
is _ _ O
spam _ _ O
. _ _ O
Will _ _ O
we _ _ O
reject _ _ O
this _ _ O
message _ _ O
if _ _ O
our _ _ O
spam _ _ O
threshold _ _ O
is _ _ O
set _ _ O
at _ _ O
0.9 _ _ O
? _ _ O
Step _ _ O
1 _ _ O
: _ _ O
Set _ _ O
up _ _ O
events _ _ O
l _ _ O
F _ _ O
= _ _ O
message _ _ O
is _ _ O
spam _ _ O
, _ _ O
FC _ _ O
= _ _ O
message _ _ O
is _ _ O
good _ _ O
l _ _ O
E1 _ _ O
= _ _ O
message _ _ O
contains _ _ O
the _ _ O
word _ _ O
" _ _ O
stock _ _ O
" _ _ O
l _ _ O
E2 _ _ O
= _ _ O
message _ _ O
contains _ _ O
the _ _ O
word _ _ O
" _ _ O
undervalued _ _ O
" _ _ O


 _ _ O
Step _ _ O
2 _ _ O
: _ _ O
Identify _ _ O
probabilities _ _ O
l _ _ O
P _ _ O
( _ _ O
E1|F _ _ O
) _ _ O
= _ _ O
400 _ _ O
/ _ _ O
2000 _ _ O
= _ _ O
0.2 _ _ O
l _ _ O
p _ _ O
( _ _ O
E1|FC _ _ O
) _ _ O
= _ _ O
60 _ _ O
/ _ _ O
1000 _ _ O
= _ _ O
0.06 _ _ O
l _ _ O
p _ _ O
( _ _ O
E2|F _ _ O
) _ _ O
= _ _ O
200 _ _ O
/ _ _ O
2000 _ _ O
= _ _ O
0.1 _ _ O
l _ _ O
p _ _ O
( _ _ O
E2|FC _ _ O
) _ _ O
= _ _ O
25 _ _ O
/ _ _ O
1000 _ _ O
= _ _ O
0.025 _ _ O


 _ _ O
Two _ _ O
keywords _ _ O
( _ _ O
continued _ _ O
) _ _ O
p _ _ O
F _ _ O
E _ _ O
! _ _ O
∩ _ _ O
E _ _ O
" _ _ O
= _ _ O


 _ _ O
p _ _ O
E _ _ O
! _ _ O


 _ _ O
p _ _ O
E _ _ O
! _ _ O
F _ _ O
p _ _ O
( _ _ O
E _ _ O
" _ _ O
∣ _ _ O
F _ _ O
) _ _ O
F _ _ O
p _ _ O
E _ _ O
" _ _ O
F _ _ O
+ _ _ O
p _ _ O
E _ _ O
! _ _ O
F _ _ O
# _ _ O
p _ _ O
E _ _ O
" _ _ O
F _ _ O
# _ _ O


 _ _ O
Step _ _ O
3 _ _ O
: _ _ O
Plug _ _ O
in _ _ O
to _ _ O
Bayes _ _ O
' _ _ O
Theorem _ _ O


 _ _ O
Recall _ _ O
: _ _ O
• _ _ O
p _ _ O
( _ _ O
E1|F _ _ O
) _ _ O
= _ _ O
0.2 _ _ O
• _ _ O
p _ _ O
( _ _ O
E1|FC _ _ O
) _ _ O
= _ _ O
0.06 _ _ O
• _ _ O
p _ _ O
( _ _ O
E2|F _ _ O
) _ _ O
= _ _ O
0.1 _ _ O
• _ _ O
p _ _ O
( _ _ O
E2|FC _ _ O
) _ _ O
= _ _ O
0.025 _ _ O


 _ _ O
l _ _ O
p _ _ O
( _ _ O
F|E1 _ _ O
∩ _ _ O
E2 _ _ O
) _ _ O
= _ _ O
( _ _ O
0.2 _ _ O
× _ _ O
0.1 _ _ O
) _ _ O
/ _ _ O
( _ _ O
0.2 _ _ O
× _ _ O
0.1 _ _ O
+ _ _ O
0.06 _ _ O
× _ _ O
0.025 _ _ O
) _ _ O
l _ _ O
= _ _ O
0.02 _ _ O
/ _ _ O
( _ _ O
0.02 _ _ O
+ _ _ O
0.0015 _ _ O
) _ _ O
l _ _ O
≈ _ _ O
0.9302 _ _ O


 _ _ O
Conclusion _ _ O
: _ _ O
Since _ _ O
the _ _ O
probability _ _ O
that _ _ O
our _ _ O
message _ _ O
is _ _ O
spam _ _ O
given _ _ O
that _ _ O
it _ _ O
contains _ _ O
the _ _ O
strings _ _ O
" _ _ O
stock _ _ O
" _ _ O
and _ _ O
" _ _ O
undervalued _ _ O
" _ _ O
is _ _ O
≈ _ _ O
0.9302 _ _ O
> _ _ O
0.9 _ _ O
, _ _ O
we _ _ O
will _ _ O
reject _ _ O
this _ _ O
message _ _ O
. _ _ O


 _ _ O
In-class _ _ O
exercises _ _ O
Problem _ _ O
3 _ _ O
: _ _ O
A _ _ O
business _ _ O
records _ _ O
incoming _ _ O
emails _ _ O
for _ _ O
1 _ _ O
week _ _ O
and _ _ O
collects _ _ O
1 _ _ O
, _ _ O
000 _ _ O
spam _ _ O
messages _ _ O
and _ _ O
400 _ _ O
non-spam _ _ O
messages _ _ O
. _ _ O
The _ _ O
word _ _ O
" _ _ O
opportunity _ _ O
" _ _ O
appears _ _ O
in _ _ O
175 _ _ O
spam _ _ O
messages _ _ O
and _ _ O
20 _ _ O
nonspam _ _ O
messages _ _ O
. _ _ O
Assuming _ _ O
this _ _ O
week _ _ O
's _ _ O
emails _ _ O
were _ _ O
typical _ _ O
( _ _ O
including _ _ O
the _ _ O
proportion _ _ O
of _ _ O
spam _ _ O
) _ _ O
, _ _ O
should _ _ O
an _ _ O
incoming _ _ O
message _ _ O
be _ _ O
labeled _ _ O
as _ _ O
spam _ _ O
if _ _ O
it _ _ O
contains _ _ O
the _ _ O
word _ _ O
" _ _ O
opportunity _ _ O
" _ _ O
and _ _ O
the _ _ O
threshold _ _ O
for _ _ O
rejecting _ _ O
is _ _ O
0.9 _ _ O
? _ _ O
Problem _ _ O
4 _ _ O
: _ _ O
Suppose _ _ O
that _ _ O
a _ _ O
Bayesian _ _ O
spam _ _ O
filter _ _ O
is _ _ O
trained _ _ O
on _ _ O
a _ _ O
set _ _ O
of _ _ O
10 _ _ O
, _ _ O
000 _ _ O
spam _ _ O
messages _ _ O
and _ _ O
5 _ _ O
, _ _ O
000 _ _ O
messages _ _ O
that _ _ O
are _ _ O
not _ _ O
spam _ _ O
. _ _ O
The _ _ O
word _ _ O
" _ _ O
enhancement _ _ O
" _ _ O
appears _ _ O
in _ _ O
1 _ _ O
, _ _ O
500 _ _ O
spam _ _ O
messages _ _ O
and _ _ O
20 _ _ O
non-spam _ _ O
messages _ _ O
, _ _ O
while _ _ O
the _ _ O
word _ _ O
" _ _ O
herbal _ _ O
" _ _ O
appears _ _ O
in _ _ O
800 _ _ O
spam _ _ O
messages _ _ O
and _ _ O
200 _ _ O
non-spam _ _ O
messages _ _ O
. _ _ O
Estimate _ _ O
the _ _ O
probability _ _ O
that _ _ O
a _ _ O
received _ _ O
message _ _ O
containing _ _ O
both _ _ O
the _ _ O
words _ _ O
" _ _ O
enhancement _ _ O
" _ _ O
and _ _ O
" _ _ O
herbal _ _ O
" _ _ O
is _ _ O
spam _ _ O
. _ _ O
Here _ _ O
, _ _ O
you _ _ O
may _ _ O
assume _ _ O
that _ _ O
50 _ _ O
% _ _ O
of _ _ O
emails _ _ O
are _ _ O
spam _ _ O
. _ _ O


 _ _ O
Final _ _ O
Thoughts _ _ O
n _ _ O
Conditional _ _ O
probability _ _ O
is _ _ O
very _ _ O
useful _ _ O
n _ _ O
Bayes _ _ O
' _ _ O
theorem _ _ O
l _ _ O
Helps _ _ O
us _ _ O
assess _ _ O
conditional _ _ O
probabilities _ _ O
l _ _ O
Has _ _ O
a _ _ O
range _ _ O
of _ _ O
important _ _ O
applications _ _ O


 _ _ O
n _ _ O
Next _ _ O
time _ _ O
: _ _ O
l _ _ O
Expected _ _ O
values _ _ O
and _ _ O
variance _ _ O
( _ _ O
Section _ _ O
7.4 _ _ O
) _ _ O


 _ _ O


