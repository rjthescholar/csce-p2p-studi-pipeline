{"id": 25, "segment": ["train_set", "labeled"], "course": "cs1550", "lec": "lec05-2", "text": "Introduction to Operating Systems\nCS/COE 1550\nSpring 2022\n\nSherif Khattab\nksm73@pitt.edu\n(Some slides are from Silberschatz, Galvin and Gagne \u00a92013)\n\nAnnouncements\n\u2022 Lectures and recitations are back in-person\n\n\u2022 Upcoming deadlines\n\u2022 Homework 2 is due next Monday at 11:59 pm\n\u2022 Lab 1 is due on 2/4 at 11:59 pm\n\u2022 Project 1 is due on 2/18 at 11:59 pm\n\u2022 Explained in this week's recitations\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n2\n\nPrevious Lecture ...\nThree-usage problems of Semaphores\n\u2022 compromising mutual exclusion\n\u2022 Solution: Mutex\n\n\u2022 deadlock\n\u2022 Solution: Not yet discussed\n\n\u2022 priority inversion\n\u2022 Solution: priority inheritance\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n3\n\nMuddiest Points (basic concepts)\n\u2022 Deadlock\n\n\u2022 mutual exclusion\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n4\n\nMuddiest Points (semaphore)\n\u2022 What the semaphore value means.\n\u2022 Can we see a process that utilizes a\nsemaphore/spinlock and trace it?\n\n\u2022 Where we move after down is called\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n5\n\nMuddiest Points (Mutex)\n\u2022 With mutex, what happens when a process tries to\nup() when it hasn't down()'d, does it skip over the\ninstruction or does it do something else?\n\u2022 how does a mutex semaphore verify that the same\nprocess that called down on it in the first place is the\none that called up on it?\n\n\u2022 Can a mutex have a negative value or is it only 0 or\n1?\n\u2022 Advantages/disadvantages of Mutex\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n6\n\nMuddiest Points (priority inheritance)\n\u2022 What is priority inheritance?\n\u2022 I'm confused on what the solution for priority\ninversion is or did we not mention it yet?\n\n\u2022 Does Priority Inheritance solve the Deadlock and\nStarvation problems along with the Priority Inversion\nproblem?\n\u2022 Why running P1 in the priority inversion question not\ndown the semaphore?\n\u2022 Does priority inversion (of semaphores) cause the\nlower process to run instead of the higher priority\nprocess indefinitely or does this resolve itself? If so\nhow?\nCS 1550 - Operating Systems - Sherif Khattab\n\n7\n\nSemaphore Usage Problem: Priority Inversion\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n8\n\nMuddiest Points (forking 1)\n\u2022 if fork creates copies of the process that called it, how\ncan you tell which copy has priority to run first?\n\u2022 child processes & where they pick up in the code\n\u2022 Not exactly sure how semaphores are inherited between\nprocesses\n\u2022 In the last example, when p1 calls fork and creates the\nchild p3, will p1's PCB be copied to p3, which means the\ncontent of p0's pcb will be in p3 too?\n\u2022 What is a PID and how is it related to the return value of\nfork()?\n\u2022 P3 is forked and created before P2 so why is it named\nP2? Is it simply renamed after P1 gets forked again?\n\u2022 Is the order of possible outcomes from a forking program\nthe permutation of any of the leaf nodes from a forking\ntree?\nCS 1550 - Operating Systems - Sherif Khattab\n\n9\n\nfork()'s of fork()'s\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n10\n\nMuddiest Points (forking 2)\n\u2022 does the fork return zero for all children?\n\u2022 Somewhat confused about what order the various forks\nwill actually form. I see why and from where they form,\nbut not how it decides which one to run\n\u2022 how are all processes a fork of another process? i know\nthe root of the tree is another process in the OS, but i\ndon't get how for example a program you create and\nexecute is a fork of something else.\n\u2022 the forking process with child processes. The\nrelationship between the number of child processes\ncreated and the number of times fork() is called by the\nparent process\n\u2022 what int fork returns for the child and parent process\n\u2022 practical uses of forking?\nCS 1550 - Operating Systems - Sherif Khattab\n\n11\n\nToday's Problem/Question\n\nHow are processes created and terminated?\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n12\n\nProcess Creation\n\u2022 Via fork() syscall\n\n\u2022 Parent process: the process that calls fork()\n\u2022 Child process: the process that gets created\n\u2022 Memory of parent process copied to child process\n\u2022 Too much copying\n\n\u2022 Even not necessary sometimes\n\u2022 e.g., fork() followed by exec() to run a different program\n\n\u2022 Optimization trick:\n\u2022 copy-on-write\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n13\n\nProcess Lifecycle (AKA Process States)\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n14\n\nProcess Termination\n\u2022 Via exit(), abort(), or kill() syscalls\n\n\u2022 The parent process may wait for termination of a\nchild process by using the wait()system call.The\ncall returns status information and the pid of the\nterminated process\npid = wait(&status);\n\u2022 When a process terminates\n\n\u2022 If no parent waiting (did not invoke wait()) process is a\nzombie\n\u2022 If parent terminated without invoking wait , process is an\norphan\n\u2022 adopted by the init process\nCS 1550 - Operating Systems - Sherif Khattab\n\n15\n\nOrphan vs. Zombie Processes\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n16\n\nBenefits of Orphan Processes\n\u2022 Allow a long-running job to continue running even\nafter session (e.g., ssh connection) ends.\n\u2022 The nohup command does that\n\n\u2022 Create daemon processes\n\u2022 Long-running background processes adopted by the init\nprocess.\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n17\n\nXv6 Code Walkthrough\n\u2022 fork()\n\n\u2022 exit()\n\u2022 wait()\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n18\n\nProcess Lifecycle (AKA Process States)\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n19\n\nKilling a waiting process\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n20\n\nThread Synchronization\nSynchronization issues apply to threads as well\n\u2022 Threads can share data easily (same address space)\n\u2022 Other two issues apply to threads\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n21\n\nProcess vs. Thread\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n22\n\nSemaphore Implementation in Project 1\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n23\n\nGetting the first entry in a list_head linked list\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n24\n\nWhy do we need Synchronization?\n\u2022 Each process operates sequentially\n\n\u2022 All is fine until processes want to share data\n\u2022 Exchange data between multiple processes\n\u2022 Allow processes to navigate critical regions\n\u2022 Maintain proper sequencing of actions in multiple\nprocesses\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n25\n\nSemaphores for general synchronization\n\u2022\n\nWe want to execute B in P1 only after A executes in P0\n\n\u2022\n\nUse a semaphore initialized to 0\n\n\u2022\n\nUse up() to notify P1 at the appropriate time\n\nShared variables\n// flag initialized to 0\nSemaphore flag(0);\n\nProcess P0\n\n.\n.\n.\n// Execute code for A\nflag.up ();\n\nProcess P1\n\n.\n.\n.\nflag.down ();\n// Execute code for B\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n26\n\nMonitors\n\u2022\n\nA monitor is another kind of high-level synchronization primitive\n\u2022\n\nOne monitor has multiple entry points\n\u2022\n\n\u2022\n\nThink multiple methods in a Java class\n\n\u2022\n\nOnly one process may be in the monitor at any time\n\n\u2022\n\nEnforces mutual exclusion - less chance for programming errors\n\nMonitors provided by high-level language\n\u2022\n\nVariables belonging to monitor are protected from simultaneous access\n\n\u2022\n\nProcedures in monitor are guaranteed to have mutual exclusion\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n27\n\n\u2022\n\u2022\n\nMonitor usage\nSupported by Java\n\u2022\n\nsynchronized keyword\n\nOnly one process can be executing in either produce or consume at any time\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n28\n\nCondition variables in monitors\n\u2022 Problem: how can a process wait inside a monitor?\n\u2022 Can't simply sleep: there's no way for anyone else to\nenter\n\u2022 Solution: use a condition variable\n\n\u2022 Condition variables support two operations\n\u2022 Wait(): suspend this process until signaled\n\u2022 Signal(): wake up exactly one process waiting on this\ncondition variable\n\u2022 If no process is waiting, signal has no effect\n\u2022 Signals on condition variables aren't \"saved up\"\n\u2022\n\nDifferent from semaphores!\n\n\u2022 Condition variables are only usable within monitors\n\u2022 Process must be in monitor to signal on a condition\nvariable\nCS 1550 - Operating Systems - Sherif Khattab\n\n29\n\nLocks & condition variables\n\u2022\n\nMonitors require native language support\n\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\nWhat if native support is not there (e.g., in C)?\n\nProvide monitor support using special data types and procedures\n\u2022\n\nLocks (Acquire(), Release())\n\n\u2022\n\nCondition variables (Wait(), Signal())\n\nLock usage\n\u2022\n\nAcquiring a lock == entering a monitor\n\n\u2022\n\nReleasing a lock == leaving a monitor\n\nCondition variable usage\n\u2022\n\nEach condition variable is associated with exactly one lock\n\n\u2022\n\nLock must be held to use condition variable\n\n\u2022\n\nWaiting on a condition variable releases the lock implicitly and reacquires the\nlock upon returning\n\nCS 1550 - Operating Systems - Sherif Khattab\n\n30\n\n", "label": [[822, 831, "Concept"], [844, 853, "Concept"], [906, 915, "Concept"], [1215, 1224, "Concept"], [1817, 1826, "Concept"], [2042, 2051, "Concept"], [5718, 5727, "Concept"], [6338, 6347, "Concept"], [6458, 6467, "Concept"], [509, 525, "Concept"], [738, 754, "Concept"], [6868, 6884, "Concept"], [7086, 7102, "Concept"], [538, 543, "Concept"], [1044, 1049, "Concept"], [1058, 1063, "Concept"], [1209, 1214, "Concept"], [1338, 1343, "Concept"], [1418, 1423, "Concept"], [547, 555, "Concept"], [726, 734, "Concept"], [1676, 1684, "Concept"], [589, 607, "Concept"], [1724, 1742, "Concept"], [1776, 1794, "Concept"], [1835, 1853, "Concept"], [2067, 2085, "Concept"], [620, 640, "Concept"], [1491, 1511, "Concept"], [1523, 1543, "Concept"], [1645, 1665, "Concept"], [916, 924, "Concept"], [2169, 2173, "Concept"], [2429, 2433, "Concept"], [2607, 2611, "Concept"], [2894, 2898, "Concept"], [2906, 2910, "Concept"], [3005, 3009, "Concept"], [3217, 3221, "Concept"], [3370, 3374, "Concept"], [3525, 3529, "Concept"], [3575, 3579, "Concept"], [3842, 3846, "Concept"], [3899, 3903, "Concept"], [4063, 4067, "Concept"], [5193, 5197, "Concept"], [3819, 3835, "Concept"], [3549, 3563, "Concept"], [3606, 3620, "Concept"], [3860, 3874, "Concept"], [3965, 3979, "Concept"], [4365, 4379, "Concept"], [3908, 3921, "Concept"], [3990, 4003, "Concept"], [4410, 4423, "Concept"], [4082, 4086, "Concept"], [3849, 3856, "Concept"], [4443, 4454, "Concept"], [4141, 4154, "Concept"], [4206, 4223, "Concept"], [5270, 5287, "Concept"], [4229, 4243, "Concept"], [5293, 5307, "Concept"], [4296, 4315, "Concept"], [4322, 4326, "Concept"], [5203, 5207, "Concept"], [4330, 4335, "Concept"], [4342, 4346, "Concept"], [4384, 4388, "Concept"], [4437, 4441, "Concept"], [4535, 4539, "Concept"], [4618, 4622, "Concept"], [4686, 4690, "Concept"], [5212, 5216, "Concept"], [7403, 7407, "Concept"], [7573, 7577, "Concept"], [8246, 8250, "Concept"], [2558, 2561, "Concept"], [4499, 4502, "Concept"], [4529, 4532, "Concept"], [4731, 4743, "Concept"], [5003, 5008, "Concept"], [5437, 5443, "Concept"], [5660, 5666, "Concept"], [5444, 5459, "Concept"], [5460, 5475, "Concept"], [5924, 5939, "Concept"], [6254, 6269, "Concept"], [6688, 6703, "Concept"], [5437, 5459, "Concept"], [1102, 1104, "Concept"], [1319, 1321, "Concept"], [2311, 2313, "Concept"], [6373, 6375, "Concept"], [6523, 6525, "Concept"], [7634, 7636, "Concept"], [7788, 7790, "Concept"], [962, 966, "Concept"], [1122, 1126, "Concept"], [1266, 1270, "Concept"], [1808, 1812, "Concept"], [6554, 6558, "Concept"], [6650, 6657, "Concept"], [6721, 6728, "Concept"], [6835, 6842, "Concept"], [6990, 6997, "Concept"], [7055, 7062, "Concept"], [7159, 7166, "Concept"], [7417, 7424, "Concept"], [7898, 7905, "Concept"], [8133, 8140, "Concept"], [8310, 8317, "Concept"], [8352, 8359, "Concept"], [7194, 7206, "Concept"], [7506, 7524, "Concept"], [7673, 7691, "Concept"], [8361, 8379, "Concept"], [8394, 8412, "Concept"], [8478, 8496, "Concept"], [8514, 8532, "Concept"], [7619, 7625, "Concept"], [7720, 7726, "Concept"], [7909, 7915, "Concept"], [8254, 8260, "Concept"], [8265, 8269, "Concept"], [8291, 8295, "Concept"], [8334, 8338, "Concept"], [8444, 8448, "Concept"], [8453, 8457, "Concept"], [8546, 8550, "Concept"], [8581, 8585, "Concept"], [8199, 8206, "Concept"], [8210, 8217, "Concept"], [5648, 5666, "Concept"], [2470, 2473, "Concept"], [2523, 2526, "Concept"]]}